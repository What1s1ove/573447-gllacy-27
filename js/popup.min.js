var modal=document.querySelector(".modal"),callbackBtn=document.querySelector(".map__callback-button"),callbackPopup=modal.querySelector(".callback-popup"),callbackPopupFrom=callbackPopup.querySelector(".callback-popup__form"),callbackPopupClose=callbackPopup.querySelector(".callback-popup__close-button"),formName=callbackPopupFrom.querySelector('input[name="feedback-name"]'),formEmail=callbackPopupFrom.querySelector('input[name="feedback-email"]'),formText=callbackPopupFrom.querySelector('textarea[name="feedback-text"]'),isStorageSupport=!0,storageName="",storageEmail="";try{storageName=localStorage.getItem("name"),storageEmail=localStorage.getItem("email")}catch(a){isStorageSupport=!1}callbackBtn.addEventListener("click",function(a){a.preventDefault(),modal.hidden=!1,callbackPopup.classList.add("callback-popup--show"),storageName&&storageEmail?(formName.value=storageName,formEmail.value=storageEmail,formText.focus()):formName.focus()}),modal.addEventListener("click",function(a){a.target===modal&&(modal.hidden=!0,callbackPopup.classList.remove("callback-popup--show"),callbackPopup.classList.remove("callback-popup--error"))}),callbackPopupClose.addEventListener("click",function(a){a.preventDefault(),modal.hidden=!0,callbackPopup.classList.remove("callback-popup--show"),callbackPopup.classList.remove("callback-popup--error")}),callbackPopupFrom.addEventListener("submit",function(a){formName.value&&formEmail.value&&formText.value?isStorageSupport&&(localStorage.setItem("name",formName.value),localStorage.setItem("email",formEmail.value)):(a.preventDefault(),callbackPopup.classList.remove("callback-popup--error"),callbackPopup.offsetWidth=callbackPopup.offsetWidth,callbackPopup.classList.add("callback-popup--error"))}),window.addEventListener("keydown",function(a){27===a.keyCode&&callbackPopup.classList.contains("callback-popup--show")&&(a.preventDefault(),modal.hidden=!0,callbackPopup.classList.remove("callback-popup--show"),callbackPopup.classList.remove("callback-popup--error"))});